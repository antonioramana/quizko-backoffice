import{r as n,W as I,j as s,Y as P,a as x}from"./app--oISFhqW.js";import{A as Q}from"./AuthenticatedLayout-DSVi8vY8.js";import{T as q,I as A}from"./TextInput-DT_McUro.js";import{I as R}from"./InputLabel-Cb622Tc0.js";import{P as T}from"./PrimaryButton-D_GEZHxU.js";import{S as M,i as $}from"./react-select-animated.esm-EkDYVW2y.js";import"./Modal-CkYoBzAA.js";import"./transition-D3AYu_rU.js";import"./SecondaryButton-CeOpsOwd.js";const z=$();function K({auth:f,questions:a,subjectData:t}){var p;const[d,u]=n.useState([]),[F,h]=n.useState([]),[b,g]=n.useState(0),{data:j,setData:m,post:v,put:N,processing:w,errors:y}=I({subject:(t==null?void 0:t.subject)||"",questions:((p=t==null?void 0:t.questions)==null?void 0:p.map(e=>e.id))||[]});n.useEffect(()=>{t&&t.questions&&(h(t.questions),u(t.questions.map(e=>({value:e.id,label:e.question,point:e.point}))),c(t.questions.map(e=>({value:e.id,label:e.question,point:e.point}))))},[t]);const S=e=>{u(e),m("questions",e.map(o=>o.value)),c(e)},c=e=>{let o=0;e.forEach(l=>{const i=a.find(r=>r.id===l.value);i&&(o+=i.point)}),g(o)},C=e=>{e.preventDefault(),t?N(route("subjects.update",t.id)):v(route("subjects.store"))},k=a.map(e=>({label:`${e.question} (${e.point} pts)`,value:e.id,point:e.point})),E={control:(e,{isFocused:o})=>({...e,backgroundColor:"white",border:"1px solid #ced4da",borderRadius:"0.375rem",boxShadow:o?"0 0 0 0.2rem rgba(0,123,255,.25)":"none",":hover":{borderColor:"#80bdff"}}),option:(e,{data:o,isDisabled:l,isFocused:i,isSelected:r})=>({...e,backgroundColor:r?"#007bff":i?"#e9ecef":"white",color:r?"white":"black",cursor:l?"not-allowed":"default",padding:"6px 12px"}),multiValue:(e,{data:o})=>({...e,backgroundColor:"#f1f3f5",borderRadius:"0.25rem",padding:"3px 6px",margin:"2px"}),multiValueRemove:(e,{data:o})=>({...e,color:"#777",":hover":{backgroundColor:"#ddd",color:"#333",cursor:"pointer"}})};return s.jsxs(Q,{user:f.user,children:[s.jsx(P,{title:t?"Modifier un sujet":"Ajouter un sujet"})," ",s.jsx(x,{className:"inline-flex items-center px-4 py-2 bg-purple-950 border border-purple-950 rounded-md font-semibold text-xs text-white uppercase tracking-widest shadow-sm hover:text-purple-950 hover:border-purple-950 hover:bg-white focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 disabled:opacity-25 transition ease-in-out duration-150 mb-6",href:route("subjects.index"),children:"Retour"}),s.jsx("div",{className:"",children:s.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8 space-y-6",children:s.jsx("div",{className:"p-4 sm:p-8 bg-gray-100 shadow sm:rounded-lg",children:s.jsxs("form",{className:"p-5",onSubmit:C,children:[" ",s.jsx("fieldset",{className:"gap-2",children:s.jsxs("div",{className:"m-2",children:[s.jsx(R,{htmlFor:"subject",value:"Sujet"}),s.jsx(q,{id:"subject",name:"subject",placeholder:"Nom du sujet ...",value:j.subject,className:"mt-1 block w-full",autoComplete:"subject",isFocused:!0,onChange:e=>m("subject",e.target.value),required:!0}),s.jsx(A,{message:y.name,className:"mt-2"})]})}),s.jsxs("div",{className:"m-2",children:[s.jsx("h2",{className:"text-black mb-2",children:"Sélectionnez les questions :"}),s.jsx(M,{options:k,value:d,onChange:S,isMulti:!0,placeholder:"Sélectionnez les questions...",styles:E,components:z,classNamePrefix:"react-select"}),s.jsxs("div",{className:"mt-4 border rounded p-2 bg-white",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Questions sélectionnées:"}),s.jsx("ul",{className:"list-disc pl-5",children:d.map((e,o)=>s.jsxs("li",{className:"text-purple-500 mb-1 flex items-center justify-between",children:[s.jsxs("span",{children:[o+1+") "," ",e.label]})," ",s.jsxs("span",{children:[e.point," pts"]})," "]},e.value))}),s.jsxs("div",{className:"mt-2 font-medium",children:["Total des points: ",b]})]})]}),s.jsxs("div",{className:"flex items-center justify-end mt-4",children:[s.jsx(x,{href:route("subjects.index"),className:"inline-flex items-center justify-center rounded-md bg-white py-2 px-5 text-center font-medium border-purple-950 border text-purple-950 hover:bg-opacity-90 lg:px-8 xl:px-10 ",children:"Annuler"}),s.jsxs(T,{className:"ml-4",type:"submit",disabled:w,children:[t?"Modifier":"Ajouter"," "]})]})]})})})})]})}export{K as default};
