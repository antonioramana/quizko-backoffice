import{r as a,W as T,j as e,Y as $,a as N}from"./app--oISFhqW.js";import{A as q,a as K}from"./AuthenticatedLayout-DSVi8vY8.js";import{D as z}from"./Datagrid-C_u-I_yz.js";import{M as x}from"./Modal-CkYoBzAA.js";import G from"./Form-D9JLLThx.js";import{C as I}from"./Chip-BpkI-or4.js";import Q from"./Edit-DSgQviaT.js";import{D as W}from"./DeletionConfirmation-Ci_NAwrw.js";import{F as Y,a as B}from"./PhoneIcon-qFTNZ_-A.js";import{F as H,a as J}from"./TrashIcon-oV8PbAGc.js";import{q as O}from"./transition-D3AYu_rU.js";import"./SecondaryButton-CeOpsOwd.js";import"./ChevronRightIcon-mwYJnyBs.js";import"./PrimaryButton-D_GEZHxU.js";import"./MagnifyingGlassIcon-8S3t9k7g.js";import"./TextInput-DT_McUro.js";import"./InputLabel-Cb622Tc0.js";import"./Select-BCFvR9KI.js";function pe({auth:n,post:t,posts:h}){const[i,o]=a.useState(!1),[v,l]=a.useState(!1),[C,f]=a.useState(!1),[d,c]=a.useState(!1),[r,u]=a.useState(null),[m,y]=a.useState(""),{data:S,setData:w,post:M,put:F,delete:_,processing:D,errors:E,reset:b,cancel:j,hasErrors:p,recentlySuccessful:g}=T({name:"",first_name:"",last_name:"",email:"",phone:"",address:"",gender:"masculine",post_id:t.id,role:"candidate",password:"",password_confirmation:""}),V=a.useMemo(()=>t.candidates.filter(s=>s.registration_number.toLowerCase().includes(m.toLowerCase())||s.user.name.toLowerCase().includes(m.toLowerCase())),[t.candidates,m]),k=P({onEdit:s=>{u(s),w(s),c(!0)},onDelete:s=>{u(s),l(!0)},onShow:s=>{u(s),f(!0)}});a.useEffect(()=>{p&&b("name"),g&&(b(),i&&o(!1),d&&c(!1))},[p,g]);const A=s=>{s.preventDefault(),M(route("students.store"))},R=s=>{s.preventDefault(),F(route("students.update",r.id))},L=s=>{s.preventDefault(),_(route("students.destroy",r)),u(null),l(!1)};return e.jsxs(q,{user:n.user,children:[e.jsx($,{title:"Classes"}),e.jsx(N,{className:"inline-flex items-center px-4 py-2 bg-purple-950 border border-purple-950 rounded-md font-semibold text-xs text-white uppercase tracking-widest shadow-sm hover:text-purple-950 hover:border-purple-950 hover:bg-white focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 disabled:opacity-25 transition ease-in-out duration-150 mb-6",href:"/levels",children:"Retour"}),e.jsxs("h1",{className:"text-purple-950 font-bold my-2 mx-10",children:["Liste des étudiants en ",t.name]}),e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:[e.jsx("div",{className:"mb-4 flex justify-between items-center",children:e.jsx("input",{type:"text",placeholder:"Rechercher par nom ou matricule",value:m,onChange:s=>y(s.target.value),className:"w-full sm:w-1/2 px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:border-blue-400 focus:ring focus:ring-blue-200 text-sm"})}),e.jsx(z,{columns:k,rows:V,canCreate:!1})]}),e.jsxs(x,{show:i,title:"Ajouter un étudiant en "+t.name,onClose:()=>o(!1),children:[e.jsx(O,{show:p,enter:"transition ease-in-out",enterFrom:"opacity-0",leave:"transition ease-in-out",leaveTo:"opacity-0",children:e.jsx("p",{className:"text-sm text-center text-red-600 dark:text-red-400",children:"Quelque chose s'est mal passé."})}),e.jsx(G,{mode:d?"edition":"creation",data:S,setData:w,errors:E,processing:D,onSubmit:d?R:A,onCancel:()=>{j(),o(!1)}})]}),e.jsx(x,{show:d,title:"Modifier un étudiant",onClose:()=>c(!1),children:e.jsx(Q,{posts:h,onCancel:()=>c(!1),candidate:r})}),e.jsx(x,{show:C,title:"Note de l'étudiant",onClose:()=>f(!1),children:e.jsx("div",{className:"max-h-60 overflow-y-auto",children:(r==null?void 0:r.candidate_notes.length)>0?r==null?void 0:r.candidate_notes.map(s=>e.jsxs("div",{className:"flex items-center bg-white text-black rounded-md shadow-xs my-2 p-2",children:[e.jsx("div",{className:"w-1/3 text-lg font-semibold text-gray-500",children:s.interview.name}),e.jsx("div",{className:"w-1/3 flex justify-center",children:e.jsxs("span",{className:`rounded-full py-2 px-4 text-white font-semibold text-center 
                                        ${s.note!==null?"bg-red-600":"bg-green-600"} 
                                        transition-colors duration-300 ease-in-out`,children:[s.note!==null?"Note: ":"Note provisoire: ","  ",s.note!==null?s.note:s.interim_note]})}),e.jsx("div",{className:"w-1/3 flex justify-end",children:e.jsx(N,{href:route("student_answers.studentTestAnswers",[r==null?void 0:r.id,s.interview.id]),className:"bg-purple-950 py-2 px-5 text-sm font-medium text-white rounded-full hover:bg-purple-850 transition-all",children:"Visualiser les résultats"})})]},s.id)):e.jsx("div",{className:"bg-red-800 text-white rounded-md my-2 p-3",children:"Aucune note disponible"})})}),e.jsx(x,{show:v,title:"Supprimer un étudiant",onClose:()=>l(!1),children:e.jsx(W,{name:r==null?void 0:r.user.name,onCancel:()=>{j(),l(!1)},handleDeleteSubmit:L})})]})}const P=n=>a.useMemo(()=>[{accessorKey:"registration_number",cell:t=>e.jsx("span",{className:"bg-gray-200 p-2 rounded-md text-black",children:t.getValue()}),header:()=>"Matricule"},{accessorFn:t=>t.user,id:"last_name",cell:t=>{const{email:h,phone:i,name:o}=t.getValue();return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(K,{size:"lg",src:"",alt:o}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-[16px] font-semibold",children:o}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"flex items-center gap-1 text-xs font-thin italic",children:[e.jsx(Y,{className:"w-3 h-3"}),h]}),i&&e.jsxs("span",{className:"flex items-center gap-1 text-xs font-thin italic",children:[e.jsx(B,{className:"w-3 h-3"}),i]})]})]})]})},header:()=>"Candidat"},{accessorKey:"gender",cell:t=>e.jsx(I,{type:t.getValue()==="feminine"?"success":"error",children:t.getValue()==="feminine"?"Féminin":"Masculin"}),header:()=>"Genre"},{accessorFn:t=>t,id:"id",cell:t=>e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("button",{className:"p-1 border border-transparent rounded-md",onClick:()=>{n.onShow(t.getValue())},children:e.jsx("span",{className:"w-6 h-4 text-purple-700 p-1 rounded-md border-3 border-white",children:"Voir les notes"})}),e.jsx("button",{className:"p-1 border border-transparent rounded-md",onClick:()=>{n.onEdit(t.getValue())},children:e.jsx(H,{className:"w-6 h-4 text-purple-950 border-3 border-white"})}),e.jsx("button",{className:"p-1 border border-transparent rounded-md",onClick:()=>{n.onDelete(t.getValue())},children:e.jsx(J,{className:"w-6 h-4 text-red-600 border-3 border-white"})})]}),header:()=>"Actions"}],[n]);export{pe as default};
