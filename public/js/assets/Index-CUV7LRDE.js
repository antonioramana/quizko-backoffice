import{r,W as I,j as e,Y as U,a as W}from"./app--oISFhqW.js";import{A as Y}from"./AuthenticatedLayout-DSVi8vY8.js";import{D as z}from"./Datagrid-C_u-I_yz.js";import{M as j}from"./Modal-CkYoBzAA.js";import V from"./Form-DMpY3hDF.js";import{D as B}from"./DeletionConfirmation-Ci_NAwrw.js";import{g as G}from"./generateUniqueColor-Cj-zfR5N.js";import{f as M}from"./formatDate-Bhi5lhCb.js";import{F as H,a as J,b as O}from"./TrashIcon-79Z-s5Od.js";import{q as E}from"./transition-D3AYu_rU.js";import"./SecondaryButton-CeOpsOwd.js";import"./ChevronRightIcon-mwYJnyBs.js";import"./PrimaryButton-D_GEZHxU.js";import"./MagnifyingGlassIcon-8S3t9k7g.js";import"./TextInput-DT_McUro.js";import"./InputLabel-Cb622Tc0.js";import"./Select-BCFvR9KI.js";function he({auth:a,interviews:t,subjects:g,posts:w}){const[C,n]=r.useState(!1),[k,d]=r.useState(!1),[c,i]=r.useState(!1),[o,u]=r.useState(null),[l,N]=r.useState(""),[m,F]=r.useState(""),{data:x,setData:p,post:R,put:$,delete:K,processing:y,errors:S,reset:h,cancel:b,hasErrors:f,recentlySuccessful:v}=I({name:"",start_date:"",end_date:"",time:"",subject_id:"",post_id:""}),_=P({onEdit:s=>{u(s),p(s),i(!0)},onDelete:s=>{u(s),d(!0)}});r.useEffect(()=>{v&&(h(),C&&n(!1),c&&i(!1))},[f,v]);const q=s=>{s.preventDefault(),R(route("tests.store"))},D=s=>{s.preventDefault(),$(route("tests.update",o.id)),console.log(x)},A=s=>{s.preventDefault(),K(route("tests.destroy",o)),u(null),d(!1)},T=r.useMemo(()=>t.filter(s=>{const L=s.name.toLowerCase().includes(m.toLowerCase()),Q=l?s.post.name===l:!0;return L&&Q}),[t,m,l]);return e.jsxs(Y,{user:a.user,children:[e.jsx(U,{title:"Tests"}),e.jsx("div",{className:"",children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:[e.jsx("div",{className:"mb-4 flex justify-between items-center space-x-4",children:e.jsxs("div",{className:"flex text-black items-center space-x-4",children:[e.jsx("label",{className:"font-semibold",children:"Rechercher :"}),e.jsx("input",{type:"text",placeholder:"test...",value:m,onChange:s=>F(s.target.value),className:"p-2 border border-gray-300 rounded-md"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("div",{className:`text-md text-purple-950 px-2 py-1 rounded-md cursor-pointer ${l===""?"border-2 border-white bg-purple-950 text-white":"border-2 border-transparent"} hover:border-purple-500`,onClick:()=>N(""),children:"Tous"}),w.length>0&&w.map(s=>e.jsx("div",{className:`text-md text-purple-950 px-2 py-1 rounded-md cursor-pointer ${l===s.name?"border-2 border-white bg-purple-950 text-white":"border-2 border-transparent"} hover:border-purple-500`,onClick:()=>N(s.name),children:s.name},s.id))]})]})}),e.jsx(z,{columns:_,rows:T,canCreate:!0,onCreate:()=>n(!0)})]})}),e.jsxs(j,{show:C,title:"Ajouter un test",onClose:()=>n(!1),children:[e.jsx(E,{show:f,enter:"transition ease-in-out",enterFrom:"opacity-0",leave:"transition ease-in-out",leaveTo:"opacity-0",children:e.jsx("p",{className:"text-sm text-center text-red-600 dark:text-red-400",children:"Quelque chose s'est mal passé."})}),e.jsx(V,{mode:c?"editon":"creation",data:x,setData:p,errors:S,processing:y,onSubmit:c?D:q,onCancel:()=>{b(),n(!1)},onReset:()=>h("name")})]}),e.jsxs(j,{show:c,title:"Modifier un test",onClose:()=>i(!1),children:[e.jsx(E,{show:f,enter:"transition ease-in-out",enterFrom:"opacity-0",leave:"transition ease-in-out",leaveTo:"opacity-0",children:e.jsx("p",{className:"text-sm text-center text-red-600 dark:text-red-400",children:"Quelque chose s'est mal passé."})}),e.jsx(V,{mode:"edition",data:x,setData:p,errors:S,processing:y,onSubmit:D,onCancel:()=>{b(),i(!1)},onReset:()=>h()})]}),e.jsx(j,{show:k,title:"Supprimer un test",onClose:()=>d(!1),children:e.jsx(B,{name:o==null?void 0:o.name,onCancel:()=>{b(),d(!1)},handleDeleteSubmit:A})})]})}const P=a=>r.useMemo(()=>[{accessorKey:"name",cell:t=>e.jsx("div",{className:"bg-gray p-1 rounded-md text-black",children:t.getValue()}),header:()=>"Nom du test"},{accessorKey:"start_date",cell:t=>`${M(t.getValue())}`,header:()=>"Début"},{accessorKey:"end_date",cell:t=>`${M(t.getValue())}`,header:()=>"Fin"},{accessorKey:"time",cell:t=>e.jsx("span",{className:"bg-red-800 p-1 rounded-md text-white",children:t.getValue()}),header:()=>"Durée"},{accessorKey:"post.name",cell:t=>{const g=G(t.getValue());return e.jsx("div",{className:"text-white text-center  rounded-md text-xs p-1",style:{backgroundColor:g},children:t.getValue()})},header:()=>"Classe"},{accessorKey:"subject.subject",cell:t=>`${t.getValue()}`,header:()=>"Sujet"},{accessorKey:"is_expired",cell:t=>e.jsx("span",{className:`px-2 py-1 inline-flex text-xs font-semibold rounded-md ${t.getValue()?"text-red-800":"text-green-400"}`,children:t.getValue()?"Expiré":"Non expiré"}),header:()=>"Status"},{accessorFn:t=>t,id:"id",cell:t=>e.jsxs("div",{className:"flex space-x-1",children:[e.jsx(W,{href:route("tests.current",t.getValue()),className:"p-1 border border-transparent rounded-md",children:e.jsx(H,{className:"w-6 h-4 text-gray-500 border-3 border-white"})}),e.jsx("button",{className:"p-1 border border-transparent rounded-md",onClick:()=>a.onEdit(t.getValue()),children:e.jsx(J,{className:"w-6 h-4 text-purple-900 border-3 border-white"})}),e.jsx("button",{className:"p-1 border border-transparent rounded-md",onClick:()=>a.onDelete(t.getValue()),children:e.jsx(O,{className:"w-6 h-4 text-red-600 border-3 border-white"})})]}),header:()=>"Action"}],[a]);export{he as default};
