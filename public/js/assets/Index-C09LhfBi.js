import{r as n,W as V,j as e,Y as B}from"./app--oISFhqW.js";import{A as L}from"./AuthenticatedLayout-DSVi8vY8.js";import{D as O}from"./Datagrid-C_u-I_yz.js";import{M as h}from"./Modal-CkYoBzAA.js";import v from"./Form-CrjTSLW0.js";import{D as P}from"./DeletionConfirmation-Ci_NAwrw.js";import{P as M}from"./PrimaryButton-D_GEZHxU.js";import{C as Z}from"./Chip-BpkI-or4.js";import{A as I}from"./ActionButtons-CzZbvkZ1.js";import{F as U,a as W}from"./XMarkIcon-CqAvwSaW.js";import"./SecondaryButton-CeOpsOwd.js";import"./ChevronRightIcon-mwYJnyBs.js";import"./MagnifyingGlassIcon-8S3t9k7g.js";import"./transition-D3AYu_rU.js";import"./TextInput-DT_McUro.js";import"./InputLabel-Cb622Tc0.js";import"./Select-BCFvR9KI.js";import"./TrashIcon-CxRs83FN.js";function Y({title:r,titleId:s,...i},l){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":s},i),r?n.createElement("title",{id:s},r):null,n.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 1 1-16 0 8 8 0 0 1 16 0ZM8.94 6.94a.75.75 0 1 1-1.061-1.061 3 3 0 1 1 2.871 5.026v.345a.75.75 0 0 1-1.5 0v-.5c0-.72.57-1.172 1.081-1.287A1.5 1.5 0 1 0 8.94 6.94ZM10 15a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z",clipRule:"evenodd"}))}const _=n.forwardRef(Y);function z(r,s=100){return r.length>s?`${r.substring(0,s)} .......`:r}function pe({auth:r,questions:s}){const[i,l]=n.useState(!1),[q,c]=n.useState(!1),[b,d]=n.useState(!1),[E,x]=n.useState(!1),[o,u]=n.useState(null),[j,R]=n.useState(""),[a,p]=n.useState(""),{data:g,setData:f,post:A,put:k,delete:D,processing:C,errors:y,reset:m,cancel:w,hasErrors:N,recentlySuccessful:S}=V({question:"",point:0,answers:[],type:"open"}),F=G({onEdit:t=>{u(t),f(t),d(!0)},onDelete:t=>{u(t),c(!0)},onShow:t=>{u(t),x(!0)}});n.useEffect(()=>{N&&m("question"),S&&(m(),i&&l(!1),b&&d(!1))},[N,S]);const $=()=>{A(route("questions.store"))},T=()=>{k(route("questions.update",o.id))},Q=t=>{t.preventDefault(),D(route("questions.destroy",o)),u(null),c(!1)};return e.jsxs(L,{user:r.user,children:[e.jsx(B,{title:"Questions & Réponses"}),e.jsx("div",{className:"bg-white py-1",children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-4 flex justify-between items-center space-x-4 text-black",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("label",{className:"font-semibold",children:"Rechecher :"}),e.jsx("input",{type:"text",placeholder:"question ...",value:j,onChange:t=>R(t.target.value),className:"p-2 border border-gray-300 rounded-md"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>p(""),className:`p-2 border rounded-md ${a===""?"bg-purple-950 border-white text-white":"border-gray-300 bg-white"}`,children:"Tous"}),e.jsx("button",{onClick:()=>p("open"),className:`p-2 border rounded-md ${a==="open"?"bg-purple-950 border-white text-white":"border-gray-300 bg-white"}`,children:"Ouverte"}),e.jsx("button",{onClick:()=>p("qcm"),className:`p-2 border rounded-md ${a==="qcm"?"bg-purple-950 border-white text-white":"border-gray-300 bg-white"}`,children:"QCM"})]})]}),e.jsx(M,{onClick:()=>l(!0),children:"Ajouter une question"})]}),e.jsx(O,{columns:F,rows:s.filter(t=>t.question.toLowerCase().includes(j.toLowerCase())&&(a?t.type===a:!0)),canCreate:!1,onCreate:()=>l(!0)})]})}),e.jsx(h,{show:i,title:"Ajouter une question",onClose:()=>l(!1),children:e.jsx(v,{mode:"creation",data:g,setData:f,errors:y,processing:C,onSubmit:$,onCancel:()=>{w(),l(!1)},onReset:()=>m("name")})}),e.jsx(h,{show:b,title:"Modifier une question",onClose:()=>d(!1),children:e.jsx(v,{mode:"edition",data:g,setData:f,errors:y,processing:C,onSubmit:T,onCancel:()=>{w(),d(!1)},onReset:()=>m()})}),e.jsx(h,{show:q,title:"Supprimer une question",onClose:()=>c(!1),children:e.jsx(P,{name:o==null?void 0:o.question,onCancel:()=>{w(),c(!1)},handleDeleteSubmit:Q})}),e.jsxs(h,{show:E,title:"Liste des réponses",onClose:()=>x(!1),children:[e.jsxs("div",{className:" text-purple-950",children:[e.jsxs("h1",{className:"text-lg font-semibold mb-2 flex items-center space-x-2",children:[e.jsx(_,{className:"w-6 h-6"}),e.jsxs("span",{children:[o==null?void 0:o.question,":"]})]}),e.jsxs("h2",{className:"text-md mb-4 text-brown-500",children:[o==null?void 0:o.point," points"]}),e.jsx("ul",{className:"text-xs",children:(o==null?void 0:o.answers.length)>0&&o.answers.map((t,K)=>e.jsxs("li",{className:" text-xm flex items-center mb-2",children:[e.jsx("div",{className:"m-2",children:t.is_correct?e.jsx(U,{className:"w-5 h-4 text-green-500"}):e.jsx(W,{className:"w-5 h-4 text-red-500"})}),e.jsxs("span",{className:"mr-2",children:[K+1,"-",t.answer]})]},t.id))})]}),e.jsx("div",{className:"flex items-center border-t p-2 justify-center m-4",children:e.jsx(M,{className:"mx-4 w-full",onClick:()=>x(!1),children:"Fermer"})})]})]})}const G=r=>n.useMemo(()=>[{accessorKey:"question",cell:s=>e.jsx("div",{className:"text-purple-950 rounded-md p-2",children:z(s.getValue(),40)}),header:()=>"Question"},{accessorKey:"answers",cell:s=>`${s.getValue().length}`,header:()=>"Nombre des réponses"},{accessorKey:"point",cell:s=>e.jsx("span",{className:"text-white bg-brown-500 px-2 py-1 rounded",children:s.getValue()}),header:()=>"Point"},{accessorKey:"type",header:"Type",cell:({getValue:s})=>e.jsx(Z,{type:s()==="qcm"?"success":"error",children:s()==="qcm"?"QCM":"OUVERTE"})},{accessorFn:s=>s,id:"id",cell:s=>e.jsx(I,{onView:r.onShow,onEdit:r.onEdit,onDelete:r.onDelete,info:s}),header:()=>"Action"}],[r]);export{pe as default};
